import{d as sl,a as Ie,u as al,k as Fe,r as B,m as ft,n as we,M as nl,N as rl,O as ol,c as S,h as m,b as i,q,p as G,w as u,e as U,J as Q,P as ce,x as D,s as il,E as w,o as k,i as h,I as ee,Q as ul,R as cl,t as Ye,S as dl,T as fl,H as gt,_ as gl}from"./index-DSeUM942.js";import{f as mt,i as ml,d as pl,c as kl,u as yl,s as vl,a as bl}from"./orders-BGoj80BM.js";import{l as hl}from"./users-eHn9V8bz.js";import{l as Sl}from"./submissions-C1J54hJM.js";import{u as qe,w as Nl}from"./xlsx-DrgRuPKf.js";const Cl={class:"page"},_l={class:"page-header"},Il={class:"actions"},Fl={class:"quick-filter-row"},Dl={key:0,class:"filter-hint"},$l={class:"diff-notice-header"},El={class:"header-left"},wl={class:"header-actions"},Vl={key:0},xl={key:0,class:"delete-info"},Al={class:"delete-item"},Bl={class:"delete-item"},Ul={key:1,class:"invalid-id-info"},Ol={class:"invalid-id-item"},zl={class:"invalid-value"},Tl={class:"invalid-id-item"},Kl={class:"invalid-id-item"},Ml={class:"invalid-id-item"},Rl={key:2},Ll={key:0,class:"invalid-id-warning"},Pl={key:1,class:"diff-details"},Yl={class:"field-name"},ql={class:"style-value"},Jl=["title"],Wl={key:1,class:"color-text"},Hl=["title"],Gl={key:3,class:"bold-indicator",title:"åŠ ç²—"},Xl={key:1,class:"no-style"},Ql={class:"style-value"},Zl=["title"],jl={key:1,class:"color-text"},es=["title"],ts={key:3,class:"bold-indicator",title:"åŠ ç²—"},ls={key:1,class:"no-style"},ss={class:"old-value"},as={class:"new-value"},ns={key:2,class:"delete-warning"},rs={class:"status-header"},os={key:0,class:"status-filter-badge"},is={key:0,class:"paid-date"},us={key:0,class:"status-text"},cs={key:1},ds={class:"float-button-group"},fs={name:"OrdersView"},gs=sl({...fs,setup(ms){const de=[{label:"æœªæ‰“æ¬¾",value:"UNPAID",tag:"danger"},{label:"å·²æ‰“æ¬¾",value:"PAID",tag:"success"}],pt=t=>t==null?"0.00":Number(t).toFixed(2),le="orders-page-size",d=Ie({dateRange:[],status:"",keyword:"",ownerUsername:"",page:1,size:(()=>{try{const t=localStorage.getItem(le);if(!t)return 50;const e=t.replace(/[^\d]/g,""),s=Number(e);return Number.isNaN(s)||s<=0||s>1e3?(localStorage.removeItem(le),50):(t!==String(s)&&localStorage.setItem(le,String(s)),s)}catch(t){return console.error("Error loading page size:",t),localStorage.removeItem(le),50}})()}),kt=/^[='\u2018\u2019"\u201C\u201D`\u200B-\u200F\uFEFF]+/,Je=t=>t?t.replace(kt,"").trim():"";al();const se=Fe(()=>!0),Ve=B([]),fe=B([]),xe=B(0),Ae=B(!1),V=B([]),$=B([]),ge="orders-diff-notices",me="orders-diff-notices-all",J=B([]),We="orders-acknowledged-changes",pe=1e3,yt=()=>{try{const t=localStorage.getItem(We);if(t){const e=JSON.parse(t);Array.isArray(e)&&(J.value=e)}}catch(t){console.warn("åŠ è½½å·²ç¡®è®¤å˜æ›´è®°å½•å¤±è´¥",t)}},Be=()=>{try{const t=J.value.slice(0,pe);localStorage.setItem(We,JSON.stringify(t))}catch(t){console.warn("ä¿å­˜å·²ç¡®è®¤å˜æ›´è®°å½•å¤±è´¥",t)}},vt=()=>{try{const t=localStorage.getItem(me),e=localStorage.getItem(ge);let s=[],n=[];if(t){const a=JSON.parse(t);if(Array.isArray(a)){let g=Date.now();s=a.map((f,o)=>({...f,ts:typeof(f==null?void 0:f.ts)=="number"?f.ts:g-o})).sort((f,o)=>(o.ts||0)-(f.ts||0))}}if(e){const a=JSON.parse(e);if(Array.isArray(a)){let g=Date.now();n=a.map((f,o)=>({...f,ts:typeof(f==null?void 0:f.ts)=="number"?f.ts:g-o})).sort((f,o)=>(o.ts||0)-(f.ts||0))}}s.length===0&&n.length>0?(console.log("ðŸ”„ æ£€æµ‹åˆ°æ—§ç‰ˆæœ¬ç¼“å­˜æ•°æ®ï¼Œæ­£åœ¨è¿ç§»..."),$.value=n,V.value=n.slice(0,ae),De(),w.info({message:`å·²ä»Žæ—§ç‰ˆæœ¬è¿ç§» ${n.length} æ¡å˜æ›´æé†’`,duration:3e3})):($.value=s,V.value=n)}catch(t){console.warn("åŠ è½½å˜æ›´æé†’ç¼“å­˜å¤±è´¥",t)}},De=()=>{try{const t=JSON.stringify(V.value||[]);localStorage.setItem(ge,t);const e=JSON.stringify($.value||[]);localStorage.setItem(me,e)}catch(t){if(t.name==="QuotaExceededError"||t.code===22){console.warn("localStorage è¶…é™ï¼Œå°è¯•æ¸…ç†æ—§æ•°æ®åŽé‡è¯•");try{V.value=V.value.slice(0,50);const e=JSON.stringify(V.value);localStorage.setItem(ge,e),$.value=$.value.slice(0,500);const s=JSON.stringify($.value);localStorage.setItem(me,s),w.warning({message:"å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œå·²è‡ªåŠ¨æ¸…ç†éƒ¨åˆ†åŽ†å²æé†’",duration:3e3})}catch(e){console.error("æ¸…ç†åŽä»æ— æ³•ä¿å­˜ï¼Œå·²æ”¾å¼ƒç¼“å­˜:",e),localStorage.removeItem(ge),localStorage.removeItem(me)}}else console.warn("ä¿å­˜å˜æ›´æé†’ç¼“å­˜å¤±è´¥:",t)}},He=B(""),Ge=B(!1),Ue=B(null);B(null);const bt=Fe(()=>Ve.value),ht=Fe(()=>Ae.value),St="user-order-history",W=B(""),Xe=B([]),Oe=B(!1),Nt=async()=>{Oe.value=!0;try{const[t,e]=await Promise.all([hl(),Sl().catch(()=>[])]),s=new Map;t.forEach(n=>{n!=null&&n.username&&s.set(n.username,n)}),e.forEach(n=>{const a=(n||"").trim();a&&!s.has(a)&&s.set(a,{username:a})}),Xe.value=Array.from(s.values()).sort((n,a)=>(n.username||"").localeCompare(a.username||""))}finally{Oe.value=!1}},Ct=Fe(()=>{let t=bt.value;if(se.value&&t.length>0){const e=new Map;t.forEach(n=>{const a=n.sn||"";e.set(a,(e.get(a)||0)+1)});const s=Array.from(e.entries()).filter(([n,a])=>a>1);s.length>0&&console.log("ðŸ” å‘çŽ°é‡å¤çš„ SN:",s)}if(!se.value&&W.value&&(t=t.filter(e=>e.status===W.value)),L.prop&&L.order){const e=L.order==="ascending"?1:-1;return[...t].sort((s,n)=>{if(L.prop==="status"){const f=["UNPAID","PAID"],o=f.indexOf(s.status??""),c=f.indexOf(n.status??"");return(o-c)*e}if(L.prop==="amount"){const f=s.amount??0,o=n.amount??0;return f===o?0:f>o?e:-e}const a=s[L.prop],g=n[L.prop];return a===g?0:a>g?e:-e})}return t});ft(()=>{try{const t=localStorage.getItem(le);if(t){const e=t.replace(/[^\d]/g,""),s=Number(e);(t!==String(s)||Number.isNaN(s)||s<=0||s>1e3)&&(console.warn("Cleaning invalid page size from localStorage:",t),s>0&&s<=1e3?localStorage.setItem(le,String(s)):localStorage.removeItem(le))}}catch(t){console.error("Error cleaning localStorage:",t)}vt(),yt()});const ke=B(!1),ze=B(!1),Te=B(),H=Ie({orderDate:"",trackingNumber:"",model:"",sn:"",remark:"",currency:"CNY"}),_t={trackingNumber:[{required:!0,message:"è¯·è¾“å…¥å•å·",trigger:"blur"}],sn:[{required:!0,message:"è¯·è¾“å…¥ SN",trigger:"blur"}]},Qe=B(),O=Ie({visible:!1,percent:0,timer:null}),Ke=B(new Map),b=Ie({visible:!1,loading:!1,targetId:0,form:{trackingNumber:"",model:"",sn:"",status:"",remark:"",amount:void 0}}),Me=t=>{const e=de.find(s=>s.value===t);return e?e.label:"æœªçŸ¥çŠ¶æ€"},It=t=>{const e=de.find(s=>s.value===t);return(e==null?void 0:e.tag)??"info"},Ze=async t=>{ne(),W.value===t?W.value="":W.value=t,se.value&&(d.status=W.value,d.page=1,console.log("çŠ¶æ€ç­›é€‰å˜æ›´:",W.value||"å…¨éƒ¨"),R())},Ft=async()=>{ne(),W.value="",se.value&&(d.status="",d.page=1,R())},Dt=Fe(()=>{const t=(s,n)=>{const a=String(s).replace(/[^\d]/g,""),g=Number(a);return Number.isNaN(g)||g<=0?n:g},e={page:t(d.page,1),size:t(d.size,50),keyword:d.keyword||void 0,status:d.status||void 0,ownerUsername:d.ownerUsername||void 0,sortBy:d.sortBy||void 0,sortOrder:d.sortOrder||void 0};return d.dateRange.length===2&&(e.startDate=d.dateRange[0],e.endDate=d.dateRange[1]),e}),$t=()=>{const t={keyword:d.keyword||void 0,status:d.status||void 0};return d.dateRange.length===2&&(t.startDate=d.dateRange[0],t.endDate=d.dateRange[1]),t},R=async()=>{ne(),Ae.value=!0;try{const t=Dt.value,e=await mt(t);Ve.value=e.records||[],xe.value=e.total||0}catch(t){console.error("âŒ åŠ è½½è®¢å•å¤±è´¥:",t),Ve.value=[],xe.value=0}finally{Ae.value=!1}},Et=async()=>{ne(),d.keyword=Je(d.keyword),d.page=1,await R()},wt=t=>{try{let e=String(t).replace(/[^\d]/g,"");const s=Number(e)||50,n=Math.min(Math.max(s,1),1e3);d.size=n,localStorage.setItem(le,String(n)),d.page=1,R()}catch(e){console.error("Error handling size change:",e),d.size=50,d.page=1,R()}},Vt=t=>{d.page=Number(t)||1,R()},xt=()=>{ne(),d.dateRange=[],d.status="",d.keyword="",d.page=1,d.sortBy=void 0,d.sortOrder=void 0,W.value="",L.prop="",L.order=null,R()},At=()=>{var t;(t=Qe.value)==null||t.click()},je=async()=>{try{return(await mt({page:1,size:999999})).records||[]}catch(t){return console.error("Failed to fetch all orders:",t),[]}},Bt=async t=>{if(!t||t.length===0)return[];try{const e=await je(),s=new Set(t);return e.filter(n=>n.id&&s.has(n.id))}catch(e){return console.error("Failed to fetch orders by IDs:",e),[]}},Ut=async()=>{const t=await je();return Jt(t)},ae=200,et=t=>{if(!t.length)return;const e=new Map;$.value.forEach(n=>{var f,o;const a=((f=n.after)==null?void 0:f.id)||((o=n.before)==null?void 0:o.id),g=a?`ID-${a}`:`${(n.trackingNumber||"").toUpperCase()}-${n.message}`;e.set(g,n)}),t.forEach(n=>{var f,o;const a=((f=n.after)==null?void 0:f.id)||((o=n.before)==null?void 0:o.id),g=a?`ID-${a}`:`${(n.trackingNumber||"").toUpperCase()}-${n.message}`;n.ts=Date.now(),e.set(g,n)});const s=Array.from(e.values()).sort((n,a)=>n.isDelete&&!a.isDelete?-1:!n.isDelete&&a.isDelete?1:(a.ts||0)-(n.ts||0));$.value=s,V.value=s.slice(0,ae),s.length>ae&&(console.warn(`å·®å¼‚æé†’è¿‡å¤šï¼Œå·²è‡ªåŠ¨é™åˆ¶ä¸ºæœ€æ–° ${ae} æ¡ï¼ˆå…±å‘çŽ° ${s.length} æ¡ï¼‰`),w.warning({message:`å‘çŽ° ${s.length} å¤„å˜æ›´ï¼Œä»…æ˜¾ç¤ºæœ€æ–° ${ae} æ¡ï¼ˆå¯å¯¼å‡ºå…¨éƒ¨ï¼‰`,duration:5e3,showClose:!0})),De()},Ot=()=>{$.value.forEach(t=>{var e;if(t.after){const s=(e=t.after)==null?void 0:e.id,n=t.trackingNumber||"";ye(t).forEach(g=>{var I,r,p,y;const f={è¿å•å·:"trackingNumber",åž‹å·:"model",SN:"sn",é‡‘é¢:"amount",å¤‡æ³¨:"remark"};let o="",c="",C="";if(g.endsWith("(æ ·å¼)")){const N=g.replace("(æ ·å¼)","");if(o=f[N],o){const E=`${o}BgColor`,x=`${o}FontColor`,P=`${o}Strike`,_=((I=t.after)==null?void 0:I[E])||"",T=((r=t.after)==null?void 0:r[x])||"",A=((p=t.after)==null?void 0:p[P])||!1;C=JSON.stringify({bg:_,fg:T,strike:A}),o=`${o}Style`}}else o=f[g],o&&(c=String(((y=t.after)==null?void 0:y[o])||""));o&&J.value.push({recordId:s,trackingNumber:n,field:o,value:c,styleValue:C||void 0,acknowledgedAt:Date.now()})})}}),J.value.length>pe&&(J.value=J.value.slice(0,pe)),Be(),V.value=[],$.value=[];try{localStorage.removeItem(ge),localStorage.removeItem(me)}catch{}w.success("å·²æ¸…ç©ºå˜æ›´æé†’")},zt=t=>{var a,g,f;if(!t)return;if(t.isDelete||t.isInvalidId){const o=t.recordId||((a=t.before)==null?void 0:a.id),c=t.trackingNumber||"",C=t.sn||((g=t.before)==null?void 0:g.sn)||"",I=t.isDelete?"DELETE":"INVALID_ID";J.value.unshift({recordId:o,trackingNumber:c,field:`__SPECIAL__${I}`,value:C||c,acknowledgedAt:Date.now()}),Be()}else if(t.after){const o=(f=t.after)==null?void 0:f.id,c=t.trackingNumber||"";ye(t).forEach(I=>{var E,x,P,_;const r={è¿å•å·:"trackingNumber",åž‹å·:"model",SN:"sn",é‡‘é¢:"amount",å¤‡æ³¨:"remark"};let p="",y="",N="";if(I.endsWith("(æ ·å¼)")){const T=I.replace("(æ ·å¼)","");if(p=r[T],p){const A=`${p}BgColor`,F=`${p}FontColor`,l=`${p}Strike`,v=((E=t.after)==null?void 0:E[A])||"",K=((x=t.after)==null?void 0:x[F])||"",Y=((P=t.after)==null?void 0:P[l])||!1;N=JSON.stringify({bg:v,fg:K,strike:Y}),p=`${p}Style`}}else p=r[I],p&&(y=String(((_=t.after)==null?void 0:_[p])||""));p&&J.value.unshift({recordId:o,trackingNumber:c,field:p,value:y,styleValue:N||void 0,acknowledgedAt:Date.now()})}),J.value.length>pe&&(J.value=J.value.slice(0,pe)),Be()}const e=o=>{var C,I;const c=((C=o.after)==null?void 0:C.id)||((I=o.before)==null?void 0:I.id);return c?`ID-${c}`:`${(o.trackingNumber||"").toUpperCase()}-${o.message}-${o.ts||0}`},s=e(t),n=o=>e(o)!==s;V.value=V.value.filter(n),$.value=$.value.filter(n),V.value.length<ae&&$.value.length>V.value.length&&(V.value=$.value.slice(0,ae)),De()},Tt=async t=>{if(!t.recordId){w.error("ç¼ºå°‘è®°å½•IDï¼Œæ— æ³•åˆ é™¤");return}try{await fl.confirm(`ç¡®è®¤åˆ é™¤ä»¥ä¸‹è®°å½•åŠå…¶å…³è”æ•°æ®ï¼Ÿ

è¿å•å·: ${t.trackingNumber}
åž‹å·: ${t.model||"-"}
SN: ${t.sn||"-"}

æ­¤æ“ä½œå°†åŒæ—¶åˆ é™¤ï¼š
â€¢ è®¢å•è®°å½•
â€¢ è®¢å•æ ·å¼
â€¢ ç»“è´¦è®°å½•

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`,"ç¡®è®¤åˆ é™¤",{confirmButtonText:"ç¡®è®¤åˆ é™¤",cancelButtonText:"å–æ¶ˆ",type:"warning",dangerouslyUseHTMLString:!1}),await pl(t.recordId),V.value=V.value.filter(e=>e.recordId!==t.recordId),$.value=$.value.filter(e=>e.recordId!==t.recordId),De(),await R(),w.success("åˆ é™¤æˆåŠŸ")}catch(e){e==="cancel"?w.info("å·²å–æ¶ˆåˆ é™¤"):(console.error("åˆ é™¤å¤±è´¥:",e),w.error("åˆ é™¤å¤±è´¥: "+(e.message||"æœªçŸ¥é”™è¯¯")))}},Kt=()=>{O.visible=!0,O.percent=10,O.timer&&clearInterval(O.timer),O.timer=window.setInterval(()=>{O.percent<90&&(O.percent+=10)},300)},tt=()=>{O.timer&&(clearInterval(O.timer),O.timer=null),O.percent=100,setTimeout(()=>{O.visible=!1,O.percent=0},400)},Mt=async t=>{var g,f,o;ne();const e=t.target,s=(g=e.files)==null?void 0:g[0];if(!s)return;let n,a=!1;try{n=await Ut(),n.size===0?(a=!0,console.log("ðŸ“¦ æ£€æµ‹åˆ°æ•°æ®åº“ä¸ºç©ºï¼Œè¿™æ˜¯é¦–æ¬¡å¯¼å…¥ï¼Œè·³è¿‡å·®å¼‚å¯¹æ¯”")):w.info({message:"æ­£åœ¨å‡†å¤‡æ•°æ®å¯¹æ¯”...",duration:2e3})}catch(c){console.warn("Failed to capture snapshot:",c)}Kt();try{const c=await ml(s);ve.clear();try{const y=(c==null?void 0:c.styles)||[],N=new Map;y.forEach(E=>{E.id&&N.set(`ID-${E.id}`,E)}),Ke.value=N}catch{}tt();const C=Number((c==null?void 0:c.skippedUnchanged)||0),I=Number((c==null?void 0:c.importedCount)||0);if(a&&w.success({message:`é¦–æ¬¡å¯¼å…¥å®Œæˆï¼šæˆåŠŸå¯¼å…¥ ${I} æ¡è®°å½•`,duration:5e3,showClose:!0}),!a&&Array.isArray(c==null?void 0:c.deletedRecords)&&c.deletedRecords.length>0){const y=c.deletedRecords.filter(N=>{const E=N.id,x=(N.trackingNumber||"").toUpperCase(),P=N.sn||"";return!J.value.some(_=>_.field==="__SPECIAL__DELETE"&&(_.recordId===E||_.trackingNumber.toUpperCase()===x)&&(_.value===P||_.value===x))}).map(N=>({trackingNumber:N.trackingNumber||"æœªçŸ¥",model:N.model,sn:N.sn,message:"ðŸ—‘ï¸ Excelä¸­å·²åˆ é™¤ï¼Œéœ€è¦ç¡®è®¤æ˜¯å¦ä»Žæ•°æ®åº“åˆ é™¤",isDelete:!0,recordId:N.id,before:N,after:null,ts:Date.now()}));y.length>0&&(et(y),w.warning({message:`æ£€æµ‹åˆ° ${y.length} æ¡è®°å½•åœ¨Excelä¸­å·²åˆ é™¤ï¼Œè¯·æŸ¥çœ‹æé†’å¹¶ç¡®è®¤`,duration:8e3,showClose:!0}))}!a&&Array.isArray(c==null?void 0:c.invalidIds)&&c.invalidIds.length>0&&console.log(`ðŸ“ æ£€æµ‹åˆ° ${c.invalidIds.length} ä¸ªæ–°IDï¼Œå·²ä½œä¸ºæ–°è®°å½•æ’å…¥`),await R();const r=I>0||(c==null?void 0:c.deletedRecords)&&c.deletedRecords.length>0||(c==null?void 0:c.invalidIds)&&c.invalidIds.length>0,p=(c==null?void 0:c.changedIds)||[];console.log("ðŸ” å·®å¼‚è®¡ç®—æ¡ä»¶æ£€æŸ¥:",{isFirstImport:a,hasSnapshot:!!n,snapshotSize:(n==null?void 0:n.size)||0,hasRealChanges:r,imported:I,deletedCount:((f=c==null?void 0:c.deletedRecords)==null?void 0:f.length)||0,invalidIdsCount:((o=c==null?void 0:c.invalidIds)==null?void 0:o.length)||0,changedIdsCount:p.length,changedIds:p.slice(0,10)}),!a&&n&&n.size>0&&r&&p.length>0?"requestIdleCallback"in window?requestIdleCallback(async()=>{await lt(n,p)}):setTimeout(async()=>{await lt(n,p)},500):!a&&!r&&console.log("ðŸ“‹ åŽç«¯æ£€æµ‹åˆ°æ•°æ®æœªå˜åŒ–ï¼Œè·³è¿‡å·®å¼‚è®¡ç®—"),localStorage.setItem("last-import-timestamp",String(Date.now()))}catch(c){throw tt(),c}finally{e.value=""}};let ue=!1,Re=!1;const ne=()=>{Re&&(ue=!0)},lt=async(t,e)=>{Re=!0,ue=!1;try{w.info({message:`æ­£åœ¨å¯¹æ¯” ${e.length} æ¡å˜æ›´è®°å½•...`,duration:3e3});const s=await Bt(e);if(ue)return;const n=Wt(t,s,Ke.value);if(n.length>0&&et(n),!ue&&n.length>0){const a=n.slice(0,3).map(f=>f.trackingNumber||"æœªçŸ¥").join("ã€"),g=n.length>3?` ç­‰${n.length}æ¡`:""}}catch(s){ue||(console.warn("æ•°æ®å¯¹æ¯”å¤±è´¥:",s),w.error({message:"æ•°æ®å¯¹æ¯”å¤±è´¥",duration:2e3}))}finally{Re=!1,ue=!1}},Rt=()=>{ke.value=!0},Lt=t=>{b.targetId=t.id,b.form.trackingNumber=t.trackingNumber,b.form.model=t.model??"",b.form.sn=t.sn??"",b.form.status=t.status??"",b.form.remark=t.remark??"",b.form.amount=t.amount??void 0,b.form.version=t.version??0,b.visible=!0},Pt=async()=>{if(!(!Te.value||!await Te.value.validate().catch(()=>!1))){ze.value=!0;try{const e=Object.entries(H).reduce((s,[n,a])=>(a!==""&&a!==void 0&&a!==null&&(s[n]=a),s),{});await kl(e),w.success("æ–°å¢žæˆåŠŸ"),ke.value=!1,Object.assign(H,{orderDate:"",trackingNumber:"",model:"",sn:"",remark:"",amount:void 0,currency:"CNY"}),R()}finally{ze.value=!1}}},Yt=t=>t?t.replace("T"," ").replace("Z",""):"-",qt=t=>t?t.substring(0,10):"",Jt=t=>{const e=new Map;return t.forEach(s=>{s.id&&e.set(s.id,{id:s.id,trackingNumber:s.trackingNumber,model:s.model,sn:s.sn,amount:s.amount,remark:s.remark,trackingBgColor:s.trackingBgColor,trackingFontColor:s.trackingFontColor,trackingStrike:s.trackingStrike,modelBgColor:s.modelBgColor,modelFontColor:s.modelFontColor,modelStrike:s.modelStrike,snBgColor:s.snBgColor,snFontColor:s.snFontColor,snStrike:s.snStrike,amountBgColor:s.amountBgColor,amountFontColor:s.amountFontColor,amountStrike:s.amountStrike,remarkBgColor:s.remarkBgColor,remarkFontColor:s.remarkFontColor,remarkStrike:s.remarkStrike})}),e},Wt=(t,e,s)=>{if(!t.size)return[];const n={trackingNumber:"è¿å•å·",model:"åž‹å·",sn:"SN",amount:"é‡‘é¢",remark:"å¤‡æ³¨"},a=[],g=r=>r==null?"":typeof r=="string"?r.trim():String(r),f=r=>r?/[\u4e00-\u9fa5]/.test(r):!1,o=new Map,c=r=>`${r.trackingNumber||""}|${r.sn||""}|${r.orderTime||""}`;t.forEach(r=>{(f(r.trackingNumber)||f(r.sn))&&o.set(c(r),r)});const C=(r,p=!0)=>{if(r==null||r==="")return"";const y=String(r).trim().toUpperCase();return p&&(y==="#FFFFFF"||y==="#FFF"||y==="FFFFFF"||y==="FFF"||y==="WHITE"||y==="#000000"||y==="#000"||y==="000000"||y==="000"||y==="BLACK")?"":y};console.log("ðŸ” å¼€å§‹å¯¹æ¯”å·®å¼‚ï¼ŒnextList æ•°é‡:",e.length,"prevMap æ•°é‡:",t.size),e.forEach(r=>{if(!r.id){console.warn("âš ï¸ è·³è¿‡æ²¡æœ‰IDçš„è®°å½•:",r.trackingNumber);return}const p=f(r.trackingNumber)||f(r.sn),y=p?o.get(c(r)):t.get(r.id);if(!y){if(p)return;console.log("ðŸ†• å‘çŽ°æ–°å¢žè®°å½• ID="+r.id+", è¿å•å·="+r.trackingNumber),a.push({trackingNumber:r.trackingNumber||`ID-${r.id}`,message:"ðŸ†• æ–°å¢žè®°å½•",before:{},after:{id:r.id,trackingNumber:r.trackingNumber,model:r.model,sn:r.sn,amount:r.amount,remark:r.remark}});return}const N=[],E={},x={};for(const _ of Object.keys(n)){const T=y[_],A=r[_],F=g(T),l=g(A);F!==l&&(N.push(n[_]),E[_]=T,x[_]=A)}const P=["tracking","model","sn","amount","remark"];for(const _ of P){const T=`${_}BgColor`,A=`${_}FontColor`,F=`${_}Strike`,l=C(y==null?void 0:y[T],!0),v=C(y==null?void 0:y[A],!0),K=!!(y!=null&&y[F]),Y=C(r==null?void 0:r[T],!0),Z=C(r==null?void 0:r[A],!0),X=!!(r!=null&&r[F]);if(l!==Y||v!==Z||K!==X){const M=_==="tracking"?"trackingNumber":_,te=`${n[M]||M}(æ ·å¼)`;N.includes(te)||(N.push(te),E[T]=l||void 0,E[A]=v||void 0,E[F]=K,x[T]=Y||void 0,x[A]=Z||void 0,x[F]=X)}}N.length&&(E.id=y.id,x.id=r.id,a.push({trackingNumber:r.trackingNumber||`ID-${r.id}`,message:`å­—æ®µå˜æ›´ï¼š${N.join("ã€")}`,before:E,after:x}))}),console.log("ðŸ“Š å¯¹æ¯”å®Œæˆï¼Œå‘çŽ° "+a.length+" æ¡å·®å¼‚");const I=a.filter(r=>{var A;if(!r.after||r.message&&r.message.includes("æ–°å¢žè®°å½•"))return!0;const p=(A=r.after)==null?void 0:A.id,y=r.trackingNumber||"",N=Object.keys(n).filter(F=>{var K,Y;const l=(K=r.before)==null?void 0:K[F],v=(Y=r.after)==null?void 0:Y[F];return String(l||"")!==String(v||"")}),x=["tracking","model","sn","amount","remark"].filter(F=>{var oe,ie,j,Ne,Ce,_e;const l=`${F}BgColor`,v=`${F}FontColor`,K=`${F}Strike`,Y=((oe=r.before)==null?void 0:oe[l])||"",Z=((ie=r.after)==null?void 0:ie[l])||"",X=((j=r.before)==null?void 0:j[v])||"",M=((Ne=r.after)==null?void 0:Ne[v])||"",re=!!((Ce=r.before)!=null&&Ce[K]),te=!!((_e=r.after)!=null&&_e[K]);return Y!==Z||X!==M||re!==te}),P={tracking:"trackingNumber",model:"model",sn:"sn",amount:"amount",remark:"remark"};return[...N,...x.map(F=>`${P[F]||F}Style`)].some(F=>{var v,K,Y,Z;if(F.endsWith("Style")){const X=F.replace("Style",""),M=X==="trackingNumber"?"tracking":X,re=`${M}BgColor`,te=`${M}FontColor`,oe=`${M}Strike`,ie=JSON.stringify({bg:((v=r.after)==null?void 0:v[re])||"",fg:((K=r.after)==null?void 0:K[te])||"",strike:!!((Y=r.after)!=null&&Y[oe])});return!J.value.some(j=>(j.recordId===p||j.trackingNumber.toUpperCase()===y.toUpperCase())&&j.field===F&&j.styleValue===ie)}else{const X=String(((Z=r.after)==null?void 0:Z[F])||"");return!J.value.some(M=>(M.recordId===p||M.trackingNumber.toUpperCase()===y.toUpperCase())&&M.field===F&&M.value===X)}})});return console.log("ðŸ“Š è¿‡æ»¤åŽå‰©ä½™ "+I.length+" æ¡å·®å¼‚ï¼ˆå·²ç¡®è®¤çš„å˜æ›´è¢«è¿‡æ»¤ï¼‰"),a.length>I.length&&console.warn("âš ï¸ æœ‰ "+(a.length-I.length)+" æ¡å˜æ›´å› å·²ç¡®è®¤è€Œè¢«è¿‡æ»¤"),I},ye=t=>{const e=[{key:"trackingNumber",label:"è¿å•å·"},{key:"model",label:"åž‹å·"},{key:"sn",label:"SN"},{key:"amount",label:"é‡‘é¢"},{key:"remark",label:"å¤‡æ³¨"}],s=[];return e.forEach(({key:a,label:g})=>{var c,C;const f=(c=t.before)==null?void 0:c[a],o=(C=t.after)==null?void 0:C[a];String(f??"")!==String(o??"")&&s.push(g)}),["model","sn","amount","remark"].forEach(a=>{var N,E,x,P,_,T,A;const g=`${a}BgColor`,f=`${a}FontColor`,o=`${a}Strike`,c=(N=t.before)==null?void 0:N[g],C=(E=t.after)==null?void 0:E[g],I=(x=t.before)==null?void 0:x[f],r=(P=t.after)==null?void 0:P[f],p=(_=t.before)==null?void 0:_[o],y=(T=t.after)==null?void 0:T[o];if(c!==C||I!==r||p!==y){const l=`${((A=e.find(v=>v.key===a))==null?void 0:A.label)||a}(æ ·å¼)`;s.includes(l)||s.push(l)}}),s},z=(t,e)=>{if(!t)return null;const s=e.replace("(æ ·å¼)",""),a={è¿å•å·:"tracking",åž‹å·:"model",SN:"sn",é‡‘é¢:"amount",å¤‡æ³¨:"remark"}[s];if(!a)return null;const g=`${a}BgColor`,f=`${a}FontColor`,o=`${a}Strike`,c=`${a}Bold`,C=t==null?void 0:t[g],I=t==null?void 0:t[f],r=t==null?void 0:t[o],p=t==null?void 0:t[c];return{bg:C,fg:I,strike:r,bold:p}},$e=(t,e)=>{if(!t)return"-";if(e.endsWith("(æ ·å¼)"))return null;const n={è¿å•å·:"trackingNumber",åž‹å·:"model",SN:"sn",é‡‘é¢:"amount",å¤‡æ³¨:"remark"}[e],a=n?t[n]:void 0;return e==="é‡‘é¢"&&typeof a=="number"?`ï¿¥${a.toFixed(2)}`:a==null||a===""?"-":String(a)},Ht=()=>{if(!$.value.length){w.info("æš‚æ— å¯å¯¼å‡ºçš„å˜æ›´æé†’");return}const t=$.value.length;w.info({message:`æ­£åœ¨å¯¼å‡ºå…¨éƒ¨ ${t} æ¡å˜æ›´æé†’...`,duration:2e3});const e=["è¿å•å·/SN","å˜æ›´ç±»åž‹","å˜æ›´è¯¦æƒ…","é‡å¤å•å·1","é‡å¤å•å·2","å¤‡æ³¨"],s=[];if($.value.forEach(o=>{if(o.isDelete){s.push([o.trackingNumber||"-","åˆ é™¤è®°å½•",`åž‹å·: ${o.model||"-"}, SN: ${o.sn||"-"}`,"","","Excelä¸­å·²åˆ é™¤æ­¤è®°å½•ï¼Œéœ€ç¡®è®¤æ˜¯å¦ä»Žæ•°æ®åº“åˆ é™¤"]);return}if(o.isInvalidId){s.push([o.trackingNumber||"-","æ— æ•ˆID",`Excel ID: ${o.excelId}, åž‹å·: ${o.model||"-"}, SN: ${o.sn||"-"}`,"","","Excelä¸­çš„IDä¸å­˜åœ¨äºŽæ•°æ®åº“ï¼Œå·²æŒ‰è¿å•å·+SNè‡ªåŠ¨åŒ¹é…"]);return}const c=ye(o);c.length&&c.forEach(C=>{s.push([o.trackingNumber,C,$e(o.before,C),$e(o.after,C),"",""])})}),!s.length){w.info("æš‚æ— å¯å¯¼å‡ºçš„å˜æ›´æé†’");return}const n=[e,...s],a=qe.aoa_to_sheet(n),g=[{wch:30},{wch:15},{wch:35},{wch:35},{wch:35},{wch:60}];a["!cols"]=g;const f=qe.book_new();qe.book_append_sheet(f,a,"å˜æ›´æé†’"),Nl(f,`æ•°æ®å˜æ›´æé†’-${new Date().toISOString().slice(0,10)}.xlsx`),w.success({message:`æˆåŠŸå¯¼å‡º ${t} æ¡å˜æ›´æé†’`,duration:2e3})},Gt=async()=>{var t,e;if(b.targetId){b.loading=!0;try{const s={trackingNumber:b.form.trackingNumber,model:b.form.model,sn:b.form.sn,status:b.form.status,remark:b.form.remark,amount:b.form.amount,version:b.form.version};await yl(b.targetId,s),b.visible=!1,w.success("å·²æ›´æ–°"),R()}catch(s){const n=((e=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:e.message)||(s==null?void 0:s.message)||"";(n.includes("å·²è¢«")||n.includes("ä¿®æ”¹"))&&w({type:"warning",message:"âš ï¸ è¯¥è®¢å•å·²è¢«å…¶ä»–ç”¨æˆ·ä¿®æ”¹ï¼Œå·²è‡ªåŠ¨åˆ·æ–°æœ€æ–°æ•°æ®ï¼Œè¯·é‡æ–°æ“ä½œ",duration:5e3,showClose:!0}),await R()}finally{b.loading=!1}}},st=t=>{if(t.id)return`ID-${t.id}`;const e=(t.trackingNumber||"").trim().toUpperCase(),s=(t.sn||"").trim().toUpperCase();return e&&s?`${e}#${s}`:s||e||""},Xt=async(t=!1)=>{const e=He.value.split(/\n|,|;/).map(s=>Je(s)).filter(Boolean);if(!e.length){t?fe.value=[]:w.warning("è¯·å…ˆè¾“å…¥å•å·æˆ– SN");return}Ge.value=!0;try{const s=await vl(e);if(!s.length){w.warning("æœªæŸ¥è¯¢åˆ°å¯¹åº”è®¢å•");return}const n=new Map;fe.value.forEach(a=>{const g=st(a);g&&n.set(g,a)}),s.forEach(a=>{const g=st(a);g&&n.set(g,a)}),fe.value=Array.from(n.values()),jt(),await Zt()}finally{Ge.value=!1}},ve=new Map,be=(t,e)=>{try{const s=`${t.id}-${e}`;if(ve.has(s))return ve.get(s);let n;t.id&&(n=Ke.value.get(`ID-${t.id}`));let a;if(n&&(a={tracking:{bg:n.trackingBgColor,fg:n.trackingFontColor,strike:n.trackingStrike},model:{bg:n.modelBgColor,fg:n.modelFontColor,strike:n.modelStrike},sn:{bg:n.snBgColor,fg:n.snFontColor,strike:n.snStrike},amount:{bg:n.amountBgColor,fg:n.amountFontColor,strike:n.amountStrike},remark:{bg:n.remarkBgColor,fg:n.remarkFontColor,strike:n.remarkStrike}}[e]),a||(a={tracking:{bg:t.trackingBgColor,fg:t.trackingFontColor,strike:t.trackingStrike},model:{bg:t.modelBgColor,fg:t.modelFontColor,strike:t.modelStrike},sn:{bg:t.snBgColor,fg:t.snFontColor,strike:t.snStrike},amount:{bg:t.amountBgColor,fg:t.amountFontColor,strike:t.amountStrike},remark:{bg:t.remarkBgColor,fg:t.remarkFontColor,strike:t.remarkStrike}}[e]),!a)return ve.set(s,{}),{};const g={};return a.bg&&a.bg!=="#FFFFFF"&&a.bg!=="#FFF"&&a.bg.trim()!==""&&(g["background-color"]=a.bg),a.fg&&a.fg!=="#000000"&&a.fg!=="#000"&&a.fg.trim()!==""&&(g.color=a.fg),(a.strike===!0||a.strike==="true"||a.strike===1)&&(g["text-decoration"]="line-through"),ve.set(s,g),g}catch(s){return console.warn("æ ·å¼åº”ç”¨å¤±è´¥:",s),{}}};we(se,t=>{R(),Nt()},{immediate:!0}),we(He,t=>{if(Ue.value&&clearTimeout(Ue.value),!t||!t.trim()){fe.value=[];return}Ue.value=window.setTimeout(()=>{Xt(!0)},400)});const L=Ie({prop:"",order:null}),Qt=t=>{if(ne(),t.prop==="status"){let e="";d.status?d.status==="UNPAID"?e="PAID":e="":e="UNPAID",console.log("ðŸ”„ çŠ¶æ€åˆ—å¾ªçŽ¯ç­›é€‰:",d.status||"å…¨éƒ¨","â†’",e||"å…¨éƒ¨"),W.value=e,d.status=e,d.page=1,L.prop="",L.order=null,d.sortBy=void 0,d.sortOrder=void 0,se.value&&R();return}L.prop=t.prop??"",L.order=t.order??null,se.value&&(t.order?(d.sortBy=t.prop,d.sortOrder=t.order==="ascending"?"asc":"desc"):(d.sortBy=void 0,d.sortOrder=void 0),d.page=1,R())};async function Zt(){try{await bl($t())}catch(t){console.warn("Failed to load category stats",t)}}we(()=>d.status,t=>{W.value=t});function jt(){try{localStorage.setItem(St,JSON.stringify(fe.value))}catch(t){console.warn("Failed to persist user orders",t)}}const el=()=>{const t=[document.querySelector(".el-main"),document.querySelector(".el-scrollbar__wrap"),document.scrollingElement,document.documentElement,document.body];for(const e of t)if(e&&e.scrollHeight>e.clientHeight+1)return e;return document.scrollingElement??document.documentElement??document.body},tl=()=>{const t=el(),e=150,s=t.scrollTop,n=performance.now(),a=g=>{const f=g-n,o=Math.min(f/e,1),c=1-Math.pow(1-o,4);t.scrollTop=s*(1-c),o<1&&requestAnimationFrame(a)};requestAnimationFrame(a)},at="orders-scroll",nt="orders-page";let he=null,Ee=null;const Le=()=>{const t=document.querySelector(".layout-main");if(t)return t;const e=document.querySelector(".el-main");return e||(document.scrollingElement??document.documentElement??document.body)},rt=()=>{try{const t=Number(sessionStorage.getItem(nt));!Number.isNaN(t)&&t>0&&(d.page=t)}catch{}},ot=()=>{try{const t=Number(sessionStorage.getItem(at));!Number.isNaN(t)&&t>0&&setTimeout(()=>{const e=Le();e.scrollTop=t,setTimeout(()=>{Math.abs(e.scrollTop-t)>10&&(e.scrollTop=t)},100)},50)}catch{}};let Se=null;const ll=()=>{Se||(Se=window.setTimeout(()=>{Se=null;try{const t=Le();sessionStorage.setItem(at,String(t.scrollTop))}catch{}},100))},it=()=>{Pe();const t=Le();Ee=t,he=ll,t.addEventListener("scroll",he,{passive:!0})},Pe=()=>{he&&Ee&&Ee.removeEventListener("scroll",he),he=null,Ee=null};return ft(()=>{rt(),ot(),it()}),nl(()=>{rt(),ot(),it()}),rl(()=>{Pe()}),we(()=>d.page,t=>{sessionStorage.setItem(nt,String(t))}),ol(()=>{Pe(),Se&&clearTimeout(Se),O.timer&&clearInterval(O.timer)}),(t,e)=>{const s=U("el-button"),n=U("el-date-picker"),a=U("el-form-item"),g=U("el-option"),f=U("el-select"),o=U("el-input"),c=U("el-form"),C=U("el-card"),I=U("el-check-tag"),r=U("el-tag"),p=U("el-table-column"),y=U("el-icon"),N=U("el-table"),E=U("el-tooltip"),x=U("el-pagination"),P=U("el-drawer"),_=U("el-input-number"),T=U("el-dialog"),A=U("el-progress"),F=cl("loading");return k(),S("div",Cl,[m("div",_l,[e[26]||(e[26]=m("div",null,[m("h2",null,"ç‰©æµå•å·"),m("p",{class:"sub"},"ç®¡ç†è®¢å•ä¿¡æ¯,æ”¯æŒæ‰¹é‡å¯¼å…¥å’Œå•ä¸ªæ–°å¢ž")],-1)),m("div",Il,[m("input",{ref_key:"fileInput",ref:Qe,type:"file",accept:".xls,.xlsx",hidden:"",onChange:Mt},null,544),i(s,{onClick:At},{default:u(()=>[...e[24]||(e[24]=[h("æ‰¹é‡å¯¼å…¥",-1)])]),_:1}),i(s,{type:"primary",onClick:Rt},{default:u(()=>[...e[25]||(e[25]=[h("æ–°å¢žå•å·",-1)])]),_:1})])]),i(C,null,{default:u(()=>[i(c,{inline:!0,model:d,class:"filter-form"},{default:u(()=>[i(a,{label:"æ—¥æœŸ"},{default:u(()=>[i(n,{modelValue:d.dateRange,"onUpdate:modelValue":e[0]||(e[0]=l=>d.dateRange=l),type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),i(a,{label:"çŠ¶æ€"},{default:u(()=>[i(f,{modelValue:d.status,"onUpdate:modelValue":e[1]||(e[1]=l=>d.status=l),placeholder:"å…¨éƒ¨",clearable:"",style:{width:"160px"}},{default:u(()=>[(k(),S(Q,null,ce(de,l=>i(g,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),i(a,{label:"å½’å±žç”¨æˆ·"},{default:u(()=>[i(f,{modelValue:d.ownerUsername,"onUpdate:modelValue":e[2]||(e[2]=l=>d.ownerUsername=l),filterable:"",clearable:"",placeholder:"å…¨éƒ¨",style:{width:"200px"},loading:Oe.value},{default:u(()=>[(k(!0),S(Q,null,ce(Xe.value,l=>(k(),G(g,{key:l.username,label:l.fullName?`${l.fullName}ï¼ˆ${l.username}ï¼‰`:l.username,value:l.username},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),i(a,{label:"å…³é”®å­—"},{default:u(()=>[i(o,{modelValue:d.keyword,"onUpdate:modelValue":e[3]||(e[3]=l=>d.keyword=l),placeholder:"å•å·/SN/åž‹å·"},null,8,["modelValue"])]),_:1}),i(a,null,{default:u(()=>[i(s,{type:"primary",onClick:Et},{default:u(()=>[...e[27]||(e[27]=[h("æŸ¥è¯¢",-1)])]),_:1}),i(s,{onClick:xt},{default:u(()=>[...e[28]||(e[28]=[h("é‡ç½®",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),q("",!0),m("div",{class:il(["quick-tools",{"has-filter":d.status}])},[m("div",Fl,[e[36]||(e[36]=m("span",{class:"label"},"å¿«é€Ÿç­›é€‰ï¼š",-1)),i(I,{checked:W.value==="",onClick:e[5]||(e[5]=l=>Ze(""))},{default:u(()=>[...e[33]||(e[33]=[h("å…¨éƒ¨",-1)])]),_:1},8,["checked"]),(k(),S(Q,null,ce(de,l=>i(I,{key:l.value,checked:W.value===l.value,onClick:v=>Ze(l.value)},{default:u(()=>[h(D(l.label),1)]),_:2},1032,["checked","onClick"])),64)),d.status?(k(),S("span",Dl,[e[35]||(e[35]=m("i",{class:"el-icon-warning"},null,-1)),m("strong",null,"æ­£åœ¨ç­›é€‰: "+D(Me(d.status)),1),i(s,{link:"",type:"primary",size:"small",onClick:Ft},{default:u(()=>[...e[34]||(e[34]=[h("æ¸…é™¤ç­›é€‰",-1)])]),_:1})])):q("",!0)])],2),V.value.length>0?(k(),G(C,{key:1,class:"diff-notice-card"},{header:u(()=>[m("div",$l,[m("div",El,[e[37]||(e[37]=m("i",{class:"el-icon-warning-filled",style:{color:"#f59e0b","font-size":"18px"}},null,-1)),e[38]||(e[38]=m("span",{class:"header-title"},"æ•°æ®å˜æ›´æé†’",-1)),$.value.length===V.value.length?(k(),G(r,{key:0,type:"warning",size:"small"},{default:u(()=>[h(D(V.value.length)+" æ¡ ",1)]),_:1})):(k(),G(r,{key:1,type:"warning",size:"small"},{default:u(()=>[h(" æ˜¾ç¤º "+D(V.value.length)+" æ¡ï¼Œå…± "+D($.value.length)+" æ¡ ",1)]),_:1}))]),m("div",wl,[i(s,{size:"small",onClick:Ht},{default:u(()=>[e[39]||(e[39]=h(" å¯¼å‡ºå˜æ›´ ",-1)),$.value.length>V.value.length?(k(),S("span",Vl,"(å…¨éƒ¨ "+D($.value.length)+" æ¡)",1)):q("",!0)]),_:1}),i(s,{size:"small",type:"danger",onClick:Ot},{default:u(()=>[...e[40]||(e[40]=[h("æ¸…ç©ºæé†’",-1)])]),_:1})])])]),default:u(()=>[i(N,{data:V.value,size:"small","max-height":"300"},{default:u(()=>[i(p,{prop:"trackingNumber",label:"è¿å•å·",width:"160"},{default:u(({row:l})=>[m("div",{style:ee({color:l.isDelete?"#f56c6c":"inherit",fontWeight:l.isDelete?"600":"normal"})},D(l.trackingNumber),5)]),_:1}),i(p,{label:"å˜æ›´ç±»åž‹",width:"100"},{default:u(({row:l})=>[l.isDelete?(k(),G(r,{key:0,type:"danger",size:"small"},{default:u(()=>[...e[41]||(e[41]=[m("i",{class:"el-icon-delete",style:{"margin-right":"4px"}},null,-1),h("åˆ é™¤ ",-1)])]),_:1})):l.isInvalidId?(k(),G(r,{key:1,type:"danger",size:"small"},{default:u(()=>[...e[42]||(e[42]=[m("i",{class:"el-icon-warning-filled",style:{"margin-right":"4px"}},null,-1),h("æ— æ•ˆID ",-1)])]),_:1})):(k(),G(r,{key:2,type:"warning",size:"small"},{default:u(()=>[...e[43]||(e[43]=[h("å˜æ›´",-1)])]),_:1}))]),_:1}),i(p,{label:"è¯¦ç»†ä¿¡æ¯",width:"280"},{default:u(({row:l})=>[l.isDelete?(k(),S("div",xl,[m("div",Al,[e[44]||(e[44]=m("span",{class:"field-name"},"åž‹å·:",-1)),h(" "+D(l.model||"-"),1)]),m("div",Bl,[e[45]||(e[45]=m("span",{class:"field-name"},"SN:",-1)),h(" "+D(l.sn||"-"),1)]),e[46]||(e[46]=m("div",{class:"delete-item warning-text"},[m("i",{class:"el-icon-warning",style:{"margin-right":"4px"}}),h(" å°†åŒæ—¶åˆ é™¤å…³è”çš„ç»“è´¦è®°å½• ")],-1))])):l.isInvalidId?(k(),S("div",Ul,[m("div",Ol,[e[47]||(e[47]=m("span",{class:"field-name"},"Excel ID:",-1)),e[48]||(e[48]=h()),m("span",zl,D(l.excelId),1)]),m("div",Tl,[e[49]||(e[49]=m("span",{class:"field-name"},"è¿å•å·:",-1)),h(" "+D(l.trackingNumber),1)]),m("div",Kl,[e[50]||(e[50]=m("span",{class:"field-name"},"åž‹å·:",-1)),h(" "+D(l.model||"-"),1)]),m("div",Ml,[e[51]||(e[51]=m("span",{class:"field-name"},"SN:",-1)),h(" "+D(l.sn||"-"),1)]),e[52]||(e[52]=m("div",{class:"invalid-id-item warning-text"},[m("i",{class:"el-icon-info",style:{"margin-right":"4px"}}),h(" å·²æŒ‰è¿å•å·+SNåŒ¹é…æˆ–æ’å…¥æ–°è®°å½• ")],-1))])):(k(),S("div",Rl,[(k(!0),S(Q,null,ce(ye(l),v=>(k(),G(r,{key:v,type:"warning",size:"small",style:{"margin-right":"4px"}},{default:u(()=>[h(D(v),1)]),_:2},1024))),128))]))]),_:1}),i(p,{label:"å˜æ›´è¯¦æƒ…"},{default:u(({row:l})=>[l.isInvalidId?(k(),S("div",Ll," Excelä¸­çš„IDä¸å­˜åœ¨äºŽæ•°æ®åº“ï¼ˆå¯èƒ½å·²è¢«åˆ é™¤æˆ–å¡«å†™é”™è¯¯ï¼‰ï¼Œç³»ç»Ÿå·²æŒ‰è¿å•å·+SNè‡ªåŠ¨åŒ¹é… ")):l.isDelete?(k(),S("div",ns," Excelä¸­å·²åˆ é™¤æ­¤è®°å½•ï¼Œéœ€è¦æ‰‹åŠ¨ç¡®è®¤æ˜¯å¦ä»Žæ•°æ®åº“ä¸­åˆ é™¤ ")):(k(),S("div",Pl,[(k(!0),S(Q,null,ce(ye(l),v=>{var K,Y,Z,X,M,re,te,oe,ie,j,Ne,Ce,_e,ut,ct,dt;return k(),S("div",{key:v,class:"diff-item"},[m("span",Yl,D(v)+":",1),v.endsWith("(æ ·å¼)")?(k(),S(Q,{key:0},[m("span",ql,[z(l.before,v)?(k(),S(Q,{key:0},[(K=z(l.before,v))!=null&&K.bg?(k(),S("span",{key:0,class:"color-block",style:ee({backgroundColor:(Y=z(l.before,v))==null?void 0:Y.bg}),title:(Z=z(l.before,v))==null?void 0:Z.bg},null,12,Jl)):q("",!0),(X=z(l.before,v))!=null&&X.fg?(k(),S("span",Wl,[e[53]||(e[53]=h(" å­—:",-1)),m("span",{class:"color-block",style:ee({backgroundColor:(M=z(l.before,v))==null?void 0:M.fg}),title:(re=z(l.before,v))==null?void 0:re.fg},null,12,Hl)])):q("",!0),(te=z(l.before,v))!=null&&te.strike?(k(),G(y,{key:2,title:"åˆ é™¤çº¿"},{default:u(()=>[i(Ye(gt))]),_:1})):q("",!0),(oe=z(l.before,v))!=null&&oe.bold?(k(),S("span",Gl,"B")):q("",!0)],64)):(k(),S("span",Xl,"-"))]),e[55]||(e[55]=m("span",{class:"arrow"},"â†’",-1)),m("span",Ql,[z(l.after,v)?(k(),S(Q,{key:0},[(ie=z(l.after,v))!=null&&ie.bg?(k(),S("span",{key:0,class:"color-block",style:ee({backgroundColor:(j=z(l.after,v))==null?void 0:j.bg}),title:(Ne=z(l.after,v))==null?void 0:Ne.bg},null,12,Zl)):q("",!0),(Ce=z(l.after,v))!=null&&Ce.fg?(k(),S("span",jl,[e[54]||(e[54]=h(" å­—:",-1)),m("span",{class:"color-block",style:ee({backgroundColor:(_e=z(l.after,v))==null?void 0:_e.fg}),title:(ut=z(l.after,v))==null?void 0:ut.fg},null,12,es)])):q("",!0),(ct=z(l.after,v))!=null&&ct.strike?(k(),G(y,{key:2,title:"åˆ é™¤çº¿"},{default:u(()=>[i(Ye(gt))]),_:1})):q("",!0),(dt=z(l.after,v))!=null&&dt.bold?(k(),S("span",ts,"B")):q("",!0)],64)):(k(),S("span",ls,"-"))])],64)):(k(),S(Q,{key:1},[m("span",ss,D($e(l.before,v)),1),e[56]||(e[56]=m("span",{class:"arrow"},"â†’",-1)),m("span",as,D($e(l.after,v)),1)],64))])}),128))]))]),_:1}),i(p,{label:"æ“ä½œ",width:"120"},{default:u(({row:l})=>[l.isDelete?(k(),G(s,{key:0,type:"danger",size:"small",onClick:v=>Tt(l)},{default:u(()=>[...e[57]||(e[57]=[h(" ç¡®è®¤åˆ é™¤ ",-1)])]),_:1},8,["onClick"])):(k(),G(s,{key:1,text:"",type:"primary",size:"small",onClick:v=>zt(l)},{default:u(()=>[h(D(l.isInvalidId?"çŸ¥é“äº†":"æ¸…é™¤"),1)]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])]),_:1})):q("",!0),i(C,{class:"table-card"},{default:u(()=>[ul((k(),G(N,{data:Ct.value,style:{width:"100%"},"default-sort":{prop:L.prop,order:L.order||void 0},onSortChange:Qt},{default:u(()=>[i(p,{prop:"orderTime",label:"æ—¶é—´",width:"170"},{default:u(({row:l})=>[h(D(Yt(l.orderTime)),1)]),_:1}),i(p,{prop:"trackingNumber",label:"è¿å•å·",width:"160"},{default:u(({row:l})=>[m("span",{style:ee(be(l,"tracking"))},D(l.trackingNumber),5)]),_:1}),i(p,{prop:"model",label:"åž‹å·",width:"160"},{default:u(({row:l})=>[m("span",{style:ee(be(l,"model"))},D(l.model),5)]),_:1}),i(p,{prop:"sn",label:"SN",width:"200"},{default:u(({row:l})=>[m("span",{class:"sn-text",style:ee(be(l,"sn"))},D(l.sn),5)]),_:1}),i(p,{prop:"amount",label:"é‡‘é¢",width:"100"},{default:u(({row:l})=>[m("span",{style:ee(be(l,"amount"))},[l.amount!==null&&l.amount!==void 0?(k(),S(Q,{key:0},[h("ï¿¥"+D(pt(l.amount)),1)],64)):q("",!0)],4)]),_:1}),i(p,{prop:"ownerUsername",label:"å½’å±žç”¨æˆ·",width:"100"}),i(p,{prop:"status",width:"120",sortable:"custom","sort-orders":["ascending","descending"]},{header:u(()=>[m("span",rs,[e[59]||(e[59]=h(" çŠ¶æ€ ",-1)),i(E,{effect:"dark",content:"ç‚¹å‡»ç®­å¤´å¾ªçŽ¯ç­›é€‰ï¼šå…¨éƒ¨ â†’ æœªæ‰“æ¬¾ â†’ å·²æ‰“æ¬¾",placement:"top"},{default:u(()=>[...e[58]||(e[58]=[m("i",{class:"el-icon-info-filled",style:{"margin-left":"4px",color:"#909399","font-size":"14px"}},null,-1)])]),_:1}),d.status?(k(),S("span",os,D(Me(d.status)),1)):q("",!0)])]),default:u(({row:l})=>[m("div",null,[i(r,{type:It(l.status)},{default:u(()=>[h(D(Me(l.status)),1)]),_:2},1032,["type"]),l.paidAt?(k(),S("div",is,D(qt(l.paidAt)),1)):q("",!0)])]),_:1}),i(p,{label:"å¯¼å…¥çŠ¶æ€",width:"140"},{default:u(({row:l})=>[l.imported?(k(),S("span",us,"å·²å½•å…¥ç³»ç»Ÿ")):(k(),S("span",cs,"-"))]),_:1}),i(p,{prop:"remark",label:"å¤‡æ³¨"},{default:u(({row:l})=>[m("span",{style:ee(be(l,"remark"))},D(l.remark),5)]),_:1}),i(p,{label:"æäº¤äºº",prop:"createdBy",width:"120"}),i(p,{label:"æ“ä½œ",width:"120"},{default:u(({row:l})=>[i(s,{link:"",type:"primary",onClick:v=>Lt(l)},{default:u(()=>[...e[60]||(e[60]=[h("ç¼–è¾‘",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","default-sort"])),[[F,ht.value]]),i(x,{"current-page":d.page,"onUpdate:currentPage":e[6]||(e[6]=l=>d.page=l),"page-size":d.size,"onUpdate:pageSize":e[7]||(e[7]=l=>d.size=l),"page-sizes":[20,50,100,200],layout:"total, sizes, prev, pager, next",total:xe.value,background:"",style:{"margin-top":"12px","justify-content":"flex-end"},onSizeChange:wt,onCurrentChange:Vt},null,8,["current-page","page-size","total"])]),_:1}),i(P,{modelValue:ke.value,"onUpdate:modelValue":e[14]||(e[14]=l=>ke.value=l),title:"æ–°å¢žç‰©æµå•",size:"30%","close-on-click-modal":!1,"destroy-on-close":!0},{footer:u(()=>[i(s,{onClick:e[13]||(e[13]=l=>ke.value=!1)},{default:u(()=>[...e[61]||(e[61]=[h("å–æ¶ˆ",-1)])]),_:1}),i(s,{type:"primary",loading:ze.value,onClick:Pt},{default:u(()=>[...e[62]||(e[62]=[h("ä¿å­˜",-1)])]),_:1},8,["loading"])]),default:u(()=>[i(c,{ref_key:"createFormRef",ref:Te,model:H,rules:_t,"label-width":"90px"},{default:u(()=>[i(a,{label:"æ—¥æœŸ",prop:"orderDate"},{default:u(()=>[i(n,{modelValue:H.orderDate,"onUpdate:modelValue":e[8]||(e[8]=l=>H.orderDate=l),type:"date","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),i(a,{label:"å•å·",prop:"trackingNumber"},{default:u(()=>[i(o,{modelValue:H.trackingNumber,"onUpdate:modelValue":e[9]||(e[9]=l=>H.trackingNumber=l)},null,8,["modelValue"])]),_:1}),i(a,{label:"åž‹å·"},{default:u(()=>[i(o,{modelValue:H.model,"onUpdate:modelValue":e[10]||(e[10]=l=>H.model=l)},null,8,["modelValue"])]),_:1}),i(a,{label:"SN"},{default:u(()=>[i(o,{modelValue:H.sn,"onUpdate:modelValue":e[11]||(e[11]=l=>H.sn=l)},null,8,["modelValue"])]),_:1}),i(a,{label:"å¤‡æ³¨"},{default:u(()=>[i(o,{modelValue:H.remark,"onUpdate:modelValue":e[12]||(e[12]=l=>H.remark=l),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),i(T,{modelValue:b.visible,"onUpdate:modelValue":e[22]||(e[22]=l=>b.visible=l),title:"ç¼–è¾‘ç‰©æµå•å·",width:"520px","destroy-on-close":!0},{footer:u(()=>[i(s,{onClick:e[21]||(e[21]=l=>b.visible=!1)},{default:u(()=>[...e[63]||(e[63]=[h("å–æ¶ˆ",-1)])]),_:1}),i(s,{type:"primary",loading:b.loading,onClick:Gt},{default:u(()=>[...e[64]||(e[64]=[h("ä¿å­˜",-1)])]),_:1},8,["loading"])]),default:u(()=>[i(c,{"label-width":"90px"},{default:u(()=>[i(a,{label:"è¿å•å·"},{default:u(()=>[i(o,{modelValue:b.form.trackingNumber,"onUpdate:modelValue":e[15]||(e[15]=l=>b.form.trackingNumber=l)},null,8,["modelValue"])]),_:1}),i(a,{label:"åž‹å·"},{default:u(()=>[i(o,{modelValue:b.form.model,"onUpdate:modelValue":e[16]||(e[16]=l=>b.form.model=l)},null,8,["modelValue"])]),_:1}),i(a,{label:"SN"},{default:u(()=>[i(o,{modelValue:b.form.sn,"onUpdate:modelValue":e[17]||(e[17]=l=>b.form.sn=l)},null,8,["modelValue"])]),_:1}),i(a,{label:"é‡‘é¢"},{default:u(()=>[i(_,{modelValue:b.form.amount,"onUpdate:modelValue":e[18]||(e[18]=l=>b.form.amount=l),precision:2,min:0,placeholder:"è¯·è¾“å…¥é‡‘é¢"},null,8,["modelValue"])]),_:1}),i(a,{label:"çŠ¶æ€"},{default:u(()=>[i(f,{modelValue:b.form.status,"onUpdate:modelValue":e[19]||(e[19]=l=>b.form.status=l),placeholder:"è¯·é€‰æ‹©"},{default:u(()=>[(k(),S(Q,null,ce(de,l=>i(g,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),i(a,{label:"å¤‡æ³¨"},{default:u(()=>[i(o,{modelValue:b.form.remark,"onUpdate:modelValue":e[20]||(e[20]=l=>b.form.remark=l),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(T,{modelValue:O.visible,"onUpdate:modelValue":e[23]||(e[23]=l=>O.visible=l),title:"æ‰¹é‡å¯¼å…¥ä¸­",width:"360px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":""},{default:u(()=>[e[65]||(e[65]=m("p",{class:"muted",style:{"margin-bottom":"12px"}},"æ­£åœ¨ä¸Šä¼ å¹¶è§£æžæ–‡ä»¶ï¼Œè¯·ç¨å€™â€¦",-1)),i(A,{percentage:O.percent,"stroke-width":12,status:"success"},null,8,["percentage"])]),_:1},8,["modelValue"]),m("div",ds,[i(s,{type:"primary",circle:"",class:"main-float-btn",onClick:tl},{default:u(()=>[i(y,null,{default:u(()=>[i(Ye(dl))]),_:1})]),_:1})])])}}}),Ss=gl(gs,[["__scopeId","data-v-dc727b5d"]]);export{Ss as default};
