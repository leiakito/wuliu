import{l as oe,u as de,c as ne,r as ue,d as re}from"./users-eHn9V8bz.js";import{d as ie,r as V,a as I,k as fe,c as pe,h as u,b as e,w as l,e as o,o as L,i,t as r,C as me,G as _e,Y as q,Z as z,$ as F,Q as ce,R as ve,p as j,I as be,x as C,a0 as ge,a1 as ye,H as we,K as Ve,q as Ce,F as O,a2 as Ue,E as k,T as P,_ as ke}from"./index-DSeUM942.js";const xe={class:"page users-page"},Ee={class:"page-header"},Ne={class:"card-header"},De={class:"header-actions"},Ae={class:"user-cell"},Be={class:"role-option"},Ie={class:"role-option"},Le=ie({__name:"UsersView",setup(Se){const c=V([]),x=V(!1),E=V(!1),f=I({username:"",role:"",status:""}),v=I({totalUsers:0,adminCount:0,enabledCount:0}),g=V(!1),N=V(),s=I({username:"",fullName:"",role:"USER",status:"ENABLED",password:""}),G=fe(()=>s.id?"编辑用户":"新增用户"),H={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},K=d=>{const a=["#409eff","#67c23a","#e6a23c","#f56c6c","#909399","#00a870","#9c27b0","#ff5722"],n=d.charCodeAt(0)%a.length;return a[n]},Q=()=>{v.totalUsers=c.value.length,v.adminCount=c.value.filter(d=>d.role==="ADMIN").length,v.enabledCount=c.value.filter(d=>d.status==="ENABLED").length},y=async()=>{x.value=!0;try{c.value=await oe(),Q()}finally{x.value=!1}},Y=()=>{f.username="",f.role="",f.status="",y()},Z=()=>{k.success("导出功能开发中")},S=d=>{d?Object.assign(s,d,{password:"",id:d.id}):Object.assign(s,{id:void 0,username:"",fullName:"",role:"USER",status:"ENABLED",password:""}),g.value=!0},J=async()=>{if(!(!N.value||!await N.value.validate().catch(()=>!1))){E.value=!0;try{s.id?await de(s.id,s):await ne(s),k.success("保存成功"),g.value=!1,y()}finally{E.value=!1}}},W=async d=>{const{value:a}=await P.prompt(`为 ${d.username} 设置新密码`,"重置密码",{inputType:"password",confirmButtonText:"确定",cancelButtonText:"取消"});await ue(d.id,a),k.success("密码已重置")},X=async d=>{await P.confirm(`确认删除用户 ${d.username} ?`,"提示",{type:"warning"}),await re(d.id),k.success("已删除"),y()};return y(),(d,a)=>{const n=o("el-icon"),p=o("el-button"),U=o("el-input"),m=o("el-form-item"),b=o("el-option"),D=o("el-select"),M=o("el-form"),w=o("el-card"),A=o("el-statistic"),B=o("el-col"),h=o("el-row"),_=o("el-table-column"),ee=o("el-avatar"),$=o("el-tag"),le=o("el-table"),R=o("el-radio"),ae=o("el-radio-group"),te=o("el-dialog"),se=ve("loading");return L(),pe("div",xe,[u("div",Ee,[a[12]||(a[12]=u("div",null,[u("h2",null,"用户管理"),u("p",{class:"sub"},"管理系统用户，控制访问权限和账户状态")],-1)),e(p,{type:"primary",onClick:a[0]||(a[0]=t=>S())},{default:l(()=>[e(n,null,{default:l(()=>[e(r(me))]),_:1}),a[11]||(a[11]=i(" 新增用户 ",-1))]),_:1})]),e(w,{class:"filter-card"},{default:l(()=>[e(M,{inline:!0,model:f},{default:l(()=>[e(m,{label:"用户名"},{default:l(()=>[e(U,{modelValue:f.username,"onUpdate:modelValue":a[1]||(a[1]=t=>f.username=t),placeholder:"输入用户名搜索",clearable:""},null,8,["modelValue"])]),_:1}),e(m,{label:"角色"},{default:l(()=>[e(D,{modelValue:f.role,"onUpdate:modelValue":a[2]||(a[2]=t=>f.role=t),placeholder:"选择角色",clearable:""},{default:l(()=>[e(b,{label:"管理员",value:"ADMIN"}),e(b,{label:"用户",value:"USER"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"状态"},{default:l(()=>[e(D,{modelValue:f.status,"onUpdate:modelValue":a[3]||(a[3]=t=>f.status=t),placeholder:"选择状态",clearable:""},{default:l(()=>[e(b,{label:"启用",value:"ENABLED"}),e(b,{label:"禁用",value:"DISABLED"})]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:l(()=>[e(p,{type:"primary",onClick:y},{default:l(()=>[e(n,null,{default:l(()=>[e(r(_e))]),_:1}),a[13]||(a[13]=i(" 搜索 ",-1))]),_:1}),e(p,{onClick:Y},{default:l(()=>[...a[14]||(a[14]=[i("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(h,{gutter:16,class:"stats-row"},{default:l(()=>[e(B,{xs:24,sm:8},{default:l(()=>[e(w,{class:"stat-card"},{default:l(()=>[e(A,{title:"总用户数",value:v.totalUsers},{prefix:l(()=>[e(n,null,{default:l(()=>[e(r(q))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(B,{xs:24,sm:8},{default:l(()=>[e(w,{class:"stat-card"},{default:l(()=>[e(A,{title:"管理员",value:v.adminCount},{prefix:l(()=>[e(n,{style:{color:"#f56c6c"}},{default:l(()=>[e(r(z))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(B,{xs:24,sm:8},{default:l(()=>[e(w,{class:"stat-card"},{default:l(()=>[e(A,{title:"启用用户",value:v.enabledCount},{prefix:l(()=>[e(n,{style:{color:"#67c23a"}},{default:l(()=>[e(r(F))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(w,{class:"table-card"},{header:l(()=>[u("div",Ne,[u("span",null,"用户列表 ("+C(c.value.length)+" 人)",1),u("div",De,[e(p,{size:"small",onClick:Z},{default:l(()=>[e(n,null,{default:l(()=>[e(r(Ve))]),_:1}),a[15]||(a[15]=i(" 导出 ",-1))]),_:1})])])]),default:l(()=>[ce((L(),j(le,{data:c.value,stripe:""},{default:l(()=>[e(_,{type:"index",label:"序号",width:"60"}),e(_,{prop:"username",label:"用户名",width:"160"},{default:l(({row:t})=>[u("div",Ae,[e(ee,{size:32,style:be({background:K(t.username)})},{default:l(()=>[i(C(t.username.charAt(0).toUpperCase()),1)]),_:2},1032,["style"]),u("span",null,C(t.username),1)])]),_:1}),e(_,{prop:"fullName",label:"姓名",width:"160"}),e(_,{label:"角色",width:"140"},{default:l(({row:t})=>[e($,{type:t.role==="ADMIN"?"danger":"info",effect:"dark"},{default:l(()=>[i(C(t.role==="ADMIN"?"管理员":"用户"),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"status",label:"状态",width:"120"},{default:l(({row:t})=>[e($,{type:t.status==="ENABLED"?"success":"info",size:"small"},{default:l(()=>[i(C(t.status==="ENABLED"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"createdAt",label:"创建时间",width:"180"}),e(_,{label:"操作",width:"280",fixed:"right"},{default:l(({row:t})=>[e(p,{link:"",type:"primary",onClick:T=>S(t)},{default:l(()=>[e(n,null,{default:l(()=>[e(r(ge))]),_:1}),a[16]||(a[16]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),e(p,{link:"",type:"warning",onClick:T=>W(t)},{default:l(()=>[e(n,null,{default:l(()=>[e(r(ye))]),_:1}),a[17]||(a[17]=i(" 重置密码 ",-1))]),_:1},8,["onClick"]),e(p,{link:"",type:"danger",onClick:T=>X(t)},{default:l(()=>[e(n,null,{default:l(()=>[e(r(we))]),_:1}),a[18]||(a[18]=i(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[se,x.value]])]),_:1}),e(te,{modelValue:g.value,"onUpdate:modelValue":a[10]||(a[10]=t=>g.value=t),title:G.value,width:"560px"},{footer:l(()=>[e(p,{onClick:a[9]||(a[9]=t=>g.value=!1)},{default:l(()=>[...a[23]||(a[23]=[i("取消",-1)])]),_:1}),e(p,{type:"primary",loading:E.value,onClick:J},{default:l(()=>[e(n,null,{default:l(()=>[e(r(F))]),_:1}),a[24]||(a[24]=i(" 保存 ",-1))]),_:1},8,["loading"])]),default:l(()=>[e(M,{ref_key:"formRef",ref:N,model:s,rules:H,"label-width":"100px"},{default:l(()=>[e(m,{label:"用户名",prop:"username"},{default:l(()=>[e(U,{modelValue:s.username,"onUpdate:modelValue":a[4]||(a[4]=t=>s.username=t),disabled:!!s.id,placeholder:"请输入用户名"},{prefix:l(()=>[e(n,null,{default:l(()=>[e(r(O))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(m,{label:"姓名",prop:"fullName"},{default:l(()=>[e(U,{modelValue:s.fullName,"onUpdate:modelValue":a[5]||(a[5]=t=>s.fullName=t),placeholder:"请输入姓名"},{prefix:l(()=>[e(n,null,{default:l(()=>[e(r(q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"角色",prop:"role"},{default:l(()=>[e(D,{modelValue:s.role,"onUpdate:modelValue":a[6]||(a[6]=t=>s.role=t),style:{width:"100%"}},{default:l(()=>[e(b,{label:"管理员",value:"ADMIN"},{default:l(()=>[u("div",Be,[e(n,null,{default:l(()=>[e(r(z))]),_:1}),a[19]||(a[19]=u("div",null,[u("div",null,"管理员"),u("div",{class:"role-desc"},"拥有所有权限，可管理用户和系统设置")],-1))])]),_:1}),e(b,{label:"用户",value:"USER"},{default:l(()=>[u("div",Ie,[e(n,null,{default:l(()=>[e(r(O))]),_:1}),a[20]||(a[20]=u("div",null,[u("div",null,"用户"),u("div",{class:"role-desc"},"基础权限，可查看和提交订单")],-1))])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"状态",prop:"status"},{default:l(()=>[e(ae,{modelValue:s.status,"onUpdate:modelValue":a[7]||(a[7]=t=>s.status=t)},{default:l(()=>[e(R,{label:"ENABLED"},{default:l(()=>[...a[21]||(a[21]=[i("启用",-1)])]),_:1}),e(R,{label:"DISABLED"},{default:l(()=>[...a[22]||(a[22]=[i("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),s.id?Ce("",!0):(L(),j(m,{key:0,label:"初始密码",prop:"password"},{default:l(()=>[e(U,{modelValue:s.password,"onUpdate:modelValue":a[8]||(a[8]=t=>s.password=t),type:"password",placeholder:"默认 ChangeMe123!","show-password":""},{prefix:l(()=>[e(n,null,{default:l(()=>[e(r(Ue))]),_:1})]),_:1},8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Re=ke(Le,[["__scopeId","data-v-4b5be787"]]);export{Re as default};
